<script>
    // Nueva URL con consulta SELECT B, C para obtener solo nombres y apellidos
    const sheetURL = "https://docs.google.com/spreadsheets/d/129nnMs3yOcnYcNSkRVoobSQIh5q1uWN0eJ9I3JpFyIU/gviz/tq?tqx=out:json&sheet=Form_Responses1&tq=SELECT B,C";

    let allData = []; // Para almacenar los nombres obtenidos

    // Funci√≥n para cargar los datos desde Google Sheets
    async function loadGoogleSheetData() {
        try {
            const response = await fetch(sheetURL);
            const text = await response.text();
            const jsonData = JSON.parse(text.substring(47, text.length - 2)); // Limpiar formato JSON

            const rows = jsonData.table.rows;
            console.log("üîç Debug: Todas las filas recibidas", rows);

            const list = document.getElementById("itemList");
            list.innerHTML = ""; // Limpiar lista antes de agregar los datos
            allData = []; // Resetear datos previos

            // Recorremos todas las filas desde la segunda fila (ignorando el encabezado)
            rows.forEach((row, index) => {
                if (!row.c || row.c.length < 2) return; // Saltar filas incompletas

                let firstName = row.c[0] && row.c[0].v ? row.c[0].v.trim() : "";
                let lastName = row.c[1] && row.c[1].v ? row.c[1].v.trim() : "";

                if (firstName !== "" && lastName !== "") {
                    let fullName = `${firstName} ${lastName}`;
                    allData.push(fullName);

                    let listItem = document.createElement("li");
                    listItem.textContent = fullName;
                    list.appendChild(listItem);
                }
            });

            console.log("‚úÖ Nombres extra√≠dos:", allData);

            if (allData.length === 0) {
                list.innerHTML = "<li>No data available</li>";
            }

        } catch (error) {
            console.error("‚ùå Error loading Google Sheets data:", error);
            document.getElementById("itemList").innerHTML = "<li>Error loading data</li>";
        }
    }

    // Funci√≥n para filtrar la lista seg√∫n la barra de b√∫squeda
    function filterList() {
        let query = document.getElementById("searchInput").value.toLowerCase();
        let list = document.getElementById("itemList");
        list.innerHTML = "";

        let filteredData = allData.filter(name => name.toLowerCase().includes(query));

        if (filteredData.length === 0) {
            list.innerHTML = "<li>No results found</li>";
        } else {
            filteredData.forEach(name => {
                let listItem = document.createElement("li");
                listItem.textContent = name;
                list.appendChild(listItem);
            });
        }
    }

    // Cargar los datos cuando la p√°gina se abre
    window.onload = loadGoogleSheetData;
</script>
